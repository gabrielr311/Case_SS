2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting ingestion orchestrator routine...
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Validating the environment variables...
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Environment file found, loading it...
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Environment file loaded and validated with success
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Creating minio, ragflow and redis handlers...
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Authenticated to MinIO with success
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] All handlers created with success...
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Creating HTTP sessions
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Startup process finished with success
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] There are 3 ingestion(s) to be done.
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting job 'cvm_financial_data'. Jobs progress: 1/3
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Fetching ITR files for the following years: ['2025', '2024', '2023']
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Fetching files for '2025'...
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Retrieving the last update date for CVM`s ITR...
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Last update date fetched with success: 2025-10-13T08:01:08
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Checking if a file with this update date already exists in the path 'ambipar-data/bronze/landing'
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] The file 'bronze/landing/CVM/cvm_itr-2025-2025-10-13T08:01:08.zip' is already present at the bucket so it wont be uploaded again
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] No new data for file type 'ITR' and 'DFP'. Aborting this ETL...
2025-10-19-17:39:37 [ERROR] [trace_id=19d4c77233dc49f7992bd3f9c2510653] An error ocurred while processing: 'NoneType' object is not iterable
2025-10-19-17:39:37 [ERROR] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Ending job 'cvm_financial_data' with failure...
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Ending job 'cvm_financial_data' with success...
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting job 'SND_debenture_data'. Jobs progress: 2/3
2025-10-19-17:39:37 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting the ETL for the debenture's financial events schedule...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving extracted debenture events schedule to 'bronze/landing/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'bronze/landing/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saved to bronze/landing with success...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving parsed DF as parquet to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.parquet'...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.parquet'
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saved parquet to bronze/raw with success...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting to enforce dataframe schema for passed document_type 'DEBENTURE_AGENDA_EVENTOS'...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Dataframe schema parsed with success
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Debenture events dataframe parsed and column 'yield_type' treated with sucess. Moving schedule to gold/serving and gold/export
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting to upload files to gold/export and gold/serving...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving file to 'gold/export/SND/debentures_financial_events_schedule.xlsx'...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'gold/export/SND/debentures_financial_events_schedule.xlsx'
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving file to 'gold/serving/SND/debentures_financial_events_schedule.parquet'...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'gold/serving/SND/debentures_financial_events_schedule.parquet'
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] All debenture schedule events moved to gold/serving and gold/export. Finishing financial events schedule ETL with success...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving data into Redis cache for gold layer table 'debentures_financial_events_schedule' with reference date '2025-10-19 17:39:40.484250' and trace id '19d4c77233dc49f7992bd3f9c2510653'
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Data saved into Redis cache with success
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Listing all debentures from company...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] The following debenture's data were found (listing only first 10 entries):   asset_code                                       issuer   situation
0     AMBP15  AMBIPAR PARTICIPACOES E EMPREENDIMENTOS S/A  Registrado
1     AMBP16  AMBIPAR PARTICIPACOES E EMPREENDIMENTOS S/A  Registrado
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Debentures found for current company: ['AMBP15', 'AMBP16']
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting to get the debenture's terms...
2025-10-19-17:39:40 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Getting terms for debenture 'AMBP15'. Progress: 0/2
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving extracted debenture terms schedule to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] terms for debenture 'AMBP15' fetched and treated with success.
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Debenture 'AMBP15' terms processed with success...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Getting terms for debenture 'AMBP16'. Progress: 1/2
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving extracted debenture terms schedule to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] terms for debenture 'AMBP16' fetched and treated with success.
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Debenture 'AMBP16' terms processed with success...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting to upload files to gold/export and gold/serving...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving file to 'gold/export/SND/debentures_terms.xlsx'...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'gold/export/SND/debentures_terms.xlsx'
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving file to 'gold/serving/SND/debentures_terms.parquet'...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'gold/serving/SND/debentures_terms.parquet'
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] All of the debenture terms were processed with success. Starting to move them to gold layer...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving data into Redis cache for gold layer table 'debentures_terms' with reference date '2025-10-19 17:39:41.777957' and trace id '19d4c77233dc49f7992bd3f9c2510653'
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Data saved into Redis cache with success
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting ETL to get all of the company's debenture secondary market traded price...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Listing all debentures from company...
2025-10-19-17:39:41 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] The following debenture's data were found (listing only first 10 entries):   asset_code                                       issuer   situation
0     AMBP15  AMBIPAR PARTICIPACOES E EMPREENDIMENTOS S/A  Registrado
1     AMBP16  AMBIPAR PARTICIPACOES E EMPREENDIMENTOS S/A  Registrado
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving extracted traded prices to 'bronze/landing/SND/last_updated_date=2025-10-19/DEBENTURE_PRECOS_DE_NEGOCIACAO_MERCADO_SECUNDARIO_2025-10-19.tsv'...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'bronze/landing/SND/last_updated_date=2025-10-19/DEBENTURE_PRECOS_DE_NEGOCIACAO_MERCADO_SECUNDARIO_2025-10-19.tsv'
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Treating the obtained trade prices dataframe...
2025-10-19-17:39:42 [WARNING] [trace_id=19d4c77233dc49f7992bd3f9c2510653] At least one of the companies debentures were not found in the secondary market trading prices.
                                            Company debenture's codes : ['AMBP15' 'AMBP16'] | 
                                            Company debenture's trading prices found for : ['AMBP16']
                                            
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] All treated debenture's secondary market traded prices obtained with success, moving to gold layer...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting to upload files to gold/export and gold/serving...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving file to 'gold/export/SND/debentures_secondary_market_traded_prices.xlsx'...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'gold/export/SND/debentures_secondary_market_traded_prices.xlsx'
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving file to 'gold/serving/SND/debentures_secondary_market_traded_prices.parquet'...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'gold/serving/SND/debentures_secondary_market_traded_prices.parquet'
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] ETL for the secondary market trade prices of the debenture's finished with success...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving data into Redis cache for gold layer table 'debentures_secondary_market_traded_prices' with reference date '2025-10-19 17:39:42.359183' and trace id '19d4c77233dc49f7992bd3f9c2510653'
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Data saved into Redis cache with success
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Ending job 'SND_debenture_data' with success...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting job 'b3_macroeconomic_data'. Jobs progress: 3/3
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting to retrieve macroeconomic data from B3...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] All macro data processed with success, saving to gold layer...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting to upload files to gold/export and gold/serving...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving file to 'gold/export/B3/macro_data.xlsx'...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File uplodaded with success to 'gold/export/B3/macro_data.xlsx'
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving file to 'gold/serving/B3/macro_data.parquet'...
2025-10-19-17:39:42 [WARNING] [trace_id=19d4c77233dc49f7992bd3f9c2510653] The file trying to be uploaded already exists as of path 'gold/serving/B3/macro_data.parquet'. Aborting upload...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] File saved with success
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Saving data into Redis cache for gold layer table 'macro_data' with reference date '2025-10-19 17:39:42.789765' and trace id '19d4c77233dc49f7992bd3f9c2510653'
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Data saved into Redis cache with success
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] All macro data files saved to gold layer, ending this ETL with success...
2025-10-19-17:39:42 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Ending job 'b3_macroeconomic_data' with success...
2025-10-19-17:40:13 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] All ingestion ETL jobs finished processing
2025-10-19-17:40:13 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Starting to push processed files to RagFlow`s dataset...
2025-10-19-17:40:13 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] All files pushed to the datasets with success, saving log to bucket...
2025-10-19-17:40:13 [INFO] [trace_id=19d4c77233dc49f7992bd3f9c2510653] Logs saved to bucket, ending ETL orchestrator with success...
