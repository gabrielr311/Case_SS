2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting ingestion orchestrator routine...
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Validating the environment variables...
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Environment file found, loading it...
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Environment file loaded and validated with success
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Creating minio, ragflow and redis handlers...
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Authenticated to MinIO with success
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] All handlers created with success...
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Creating HTTP sessions
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Startup process finished with success
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] There are 3 ingestion(s) to be done.
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting job 'cvm_financial_data'. Jobs progress: 1/3
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Ending job 'cvm_financial_data' with success...
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting job 'SND_debenture_data'. Jobs progress: 2/3
2025-10-19-15:51:20 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting the ETL for the debenture's financial events schedule...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving extracted debenture events schedule to 'bronze/landing/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File uplodaded with success to 'bronze/landing/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saved to bronze/landing with success...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving parsed DF as parquet to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.parquet'...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File uplodaded with success to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.parquet'
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saved parquet to bronze/raw with success...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting to enforce dataframe schema for passed document_type 'DEBENTURE_AGENDA_EVENTOS'...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Dataframe schema parsed with success
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Debenture events dataframe parsed and column 'yield_type' treated with sucess. Moving schedule to gold/serving and gold/export
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting to upload files to gold/export and gold/serving...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving file to 'gold/export/SND/debentures_financial_events_schedule.xlsx'...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File uplodaded with success to 'gold/export/SND/debentures_financial_events_schedule.xlsx'
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving file to 'gold/serving/SND/debentures_financial_events_schedule.parquet'...
2025-10-19-15:51:23 [WARNING] [trace_id=8dbd07e6b5c04269841aed85e69c020f] The file trying to be uploaded already exists as of path 'gold/serving/SND/debentures_financial_events_schedule.parquet'. Aborting upload...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] All debenture schedule events moved to gold/serving and gold/export. Finishing financial events schedule ETL with success...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Listing all debentures from company...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] The following debenture's data were found (listing only first 10 entries):   asset_code                                       issuer   situation
0     AMBP15  AMBIPAR PARTICIPACOES E EMPREENDIMENTOS S/A  Registrado
1     AMBP16  AMBIPAR PARTICIPACOES E EMPREENDIMENTOS S/A  Registrado
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Debentures found for current company: ['AMBP15', 'AMBP16']
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting to get the debenture's terms...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Getting terms for debenture 'AMBP15'. Progress: 0/2
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving extracted debenture terms schedule to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'...
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File uplodaded with success to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] terms for debenture 'AMBP15' fetched and treated with success.
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Debenture 'AMBP15' terms processed with success...
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Getting terms for debenture 'AMBP16'. Progress: 1/2
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving extracted debenture terms schedule to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'...
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File uplodaded with success to 'bronze/raw/SND/last_updated_date=2025-10-19/DEBENTURE_AGENDA_EVENTOS_2025-10-19.tsv'
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] terms for debenture 'AMBP16' fetched and treated with success.
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Debenture 'AMBP16' terms processed with success...
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting to upload files to gold/export and gold/serving...
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving file to 'gold/export/SND/debentures_terms.xlsx'...
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File uplodaded with success to 'gold/export/SND/debentures_terms.xlsx'
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving file to 'gold/serving/SND/debentures_terms.parquet'...
2025-10-19-15:51:24 [WARNING] [trace_id=8dbd07e6b5c04269841aed85e69c020f] The file trying to be uploaded already exists as of path 'gold/serving/SND/debentures_terms.parquet'. Aborting upload...
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] All of the debenture terms were processed with success. Starting to move them to gold layer...
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting ETL to get all of the company's debenture secondary market traded price...
2025-10-19-15:51:24 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Listing all debentures from company...
2025-10-19-15:51:22 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] The following debenture's data were found (listing only first 10 entries):   asset_code                                       issuer   situation
0     AMBP15  AMBIPAR PARTICIPACOES E EMPREENDIMENTOS S/A  Registrado
1     AMBP16  AMBIPAR PARTICIPACOES E EMPREENDIMENTOS S/A  Registrado
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving extracted traded prices to 'bronze/landing/SND/last_updated_date=2025-10-19/DEBENTURE_PRECOS_DE_NEGOCIACAO_MERCADO_SECUNDARIO_2025-10-19.tsv'...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File uplodaded with success to 'bronze/landing/SND/last_updated_date=2025-10-19/DEBENTURE_PRECOS_DE_NEGOCIACAO_MERCADO_SECUNDARIO_2025-10-19.tsv'
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Treating the obtained trade prices dataframe...
2025-10-19-15:51:23 [WARNING] [trace_id=8dbd07e6b5c04269841aed85e69c020f] At least one of the companies debentures were not found in the secondary market trading prices.
                                            Company debenture's codes : ['AMBP15' 'AMBP16'] | 
                                            Company debenture's trading prices found for : ['AMBP16']
                                            
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] All treated debenture's secondary market traded prices obtained with success, moving to gold layer...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting to upload files to gold/export and gold/serving...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving file to 'gold/export/SND/debentures_secondary_market_traded_prices.xlsx'...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File uplodaded with success to 'gold/export/SND/debentures_secondary_market_traded_prices.xlsx'
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving file to 'gold/serving/SND/debentures_secondary_market_traded_prices.parquet'...
2025-10-19-15:51:23 [WARNING] [trace_id=8dbd07e6b5c04269841aed85e69c020f] The file trying to be uploaded already exists as of path 'gold/serving/SND/debentures_secondary_market_traded_prices.parquet'. Aborting upload...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] ETL for the secondary market trade prices of the debenture's finished with success...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Ending job 'SND_debenture_data' with success...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting job 'b3_macroeconomic_data'. Jobs progress: 3/3
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting to retrieve macroeconomic data from B3...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] All macro data processed with success, saving to gold layer...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting to upload files to gold/export and gold/serving...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving file to 'gold/export/B3/macro_data.xlsx'...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File uplodaded with success to 'gold/export/B3/macro_data.xlsx'
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving file to 'gold/serving/B3/macro_data.parquet'...
2025-10-19-15:51:23 [WARNING] [trace_id=8dbd07e6b5c04269841aed85e69c020f] The file trying to be uploaded already exists as of path 'gold/serving/B3/macro_data.parquet'. Aborting upload...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] File saved with success
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Saving data into Redis cache for gold layer table 'macro_data' with reference date '2025-10-19 15:51:23.376954' and trace id '8dbd07e6b5c04269841aed85e69c020f'
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Data saved into Redis cache with success
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] All macro data files saved to gold layer, ending this ETL with success...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Ending job 'b3_macroeconomic_data' with success...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] All ingestion ETL jobs finished processing
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] Starting to push processed files to RagFlow`s dataset...
2025-10-19-15:51:23 [INFO] [trace_id=8dbd07e6b5c04269841aed85e69c020f] All files pushed to the datasets with success, saving log to bucket...
